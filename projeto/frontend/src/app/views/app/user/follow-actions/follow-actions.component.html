<div class="follow-container">
  <div class="container">
    <div class="follow-header fade-in">
      <h1 class="page-title">
        @if(userType === 'donor') {
          Acompanhar Doações
        } @else {
          Acompanhar Solicitações
        }
      </h1>
      <p class="page-subtitle">
        @if(userType === 'donor') {
          Visualize o status de todas as suas doações
        } @else {
          Acompanhe suas solicitações e histórico
        }
      </p>
    </div>

    <div class="follow-content">
      @if(userType === 'donor') {
        <div class="data-card card fade-in">
          <div class="card-header">
            <div class="card-icon">
              <mat-icon>volunteer_activism</mat-icon>
            </div>
            <h2>Histórico de Doações</h2>
          </div>

          <div class="table-container">
            <table class="data-table">
              <thead>
                <tr>
                  <th>
                    <mat-icon>inventory</mat-icon>
                    Produto
                  </th>
                  <th>
                    <mat-icon>scale</mat-icon>
                    Quantidade
                  </th>
                  <th>
                    <mat-icon>event</mat-icon>
                    Data
                  </th>
                  <th>
                    <mat-icon>info</mat-icon>
                    Status
                  </th>
                </tr>
              </thead>
              <tbody>
                @if(loading) {
                  <tr>
                    <td colspan="4" class="text-center">
                      <mat-icon>hourglass_empty</mat-icon>
                      Carregando...
                    </td>
                  </tr>
                } @else if(donations.length === 0) {
                  <tr class="empty-state">
                    <td colspan="4">
                      <div class="empty-content">
                        <mat-icon>inbox</mat-icon>
                        <h3>Nenhuma doação encontrada</h3>
                        <p>Suas doações registradas aparecerão aqui</p>
                      </div>
                    </td>
                  </tr>
                } @else {
                  @for(donation of donations; track donation.productName + donation.donationDate) {
                    <tr>
                      <td>
                        <div class="product-info">
                          <span class="product-name">{{ donation.productName }}</span>
                        </div>
                      </td>
                      <td>
                        <span class="quantity">{{ donation.calculatedWeight }}{{ donation.measureType }}</span>
                      </td>
                      <td>
                        <span class="date">{{ donation.donationDate ? (donation.donationDate | date:'dd/MM/yyyy') : 'Data não disponível' }}</span>
                      </td>
                      <td>
                        <span class="status status-available">{{ donation.status }}</span>
                      </td>
                    </tr>
                  }
                }
              </tbody>
            </table>
          </div>

          <div class="table-actions">
            <button class="btn btn-primary" routerLink="/main/user/make-action">
              <mat-icon>add</mat-icon>
              Nova Doação
            </button>
            <button class="btn btn-secondary">
              <mat-icon>download</mat-icon>
              Exportar Dados
            </button>
          </div>
        </div>
      }

      @if(userType === 'beneficiary') {
        <div class="data-card card fade-in">
          <div class="card-header">
            <div class="card-icon">
              <mat-icon>request_quote</mat-icon>
            </div>
            <h2>Histórico de Solicitações</h2>
          </div>

          <div class="table-container">
            <table class="data-table">
              <thead>
                <tr>
                  <th>
                    <mat-icon>shopping_basket</mat-icon>
                    Tipo
                  </th>
                  <th>
                    <mat-icon>event</mat-icon>
                    Data
                  </th>
                  <th>
                    <mat-icon>info</mat-icon>
                    Status
                  </th>
                </tr>
              </thead>
              <tbody>
                @if(loading) {
                  <tr>
                    <td colspan="3" class="text-center">
                      <mat-icon>hourglass_empty</mat-icon>
                      Carregando...
                    </td>
                  </tr>
                } @else if(basketRequests.length === 0) {
                  <tr class="empty-state">
                    <td colspan="3">
                      <div class="empty-content">
                        <mat-icon>inbox</mat-icon>
                        <h3>Nenhuma solicitação encontrada</h3>
                        <p>Suas solicitações aparecerão aqui</p>
                      </div>
                    </td>
                  </tr>
                } @else {
                  @for(request of basketRequests; track request.id) {
                    <tr>
                      <td>
                        <div class="product-info">
                          <a href="#" (click)="showBasketProducts(request); $event.preventDefault()" class="basket-link">
                            <span class="product-name">{{ request.basket_type === 'basic' ? 'Cesta Básica' : 'Cesta de Higiene' }}</span>
                          </a>
                        </div>
                      </td>
                      <td>
                        <span class="date">{{ request.request_date ? (request.request_date | date:'dd/MM/yyyy') : 'Data não disponível' }}</span>
                      </td>
                      <td>
                        <span class="status status-available">{{ request.status === 'pending' ? 'Pendente' : 'Coletada' }}</span>
                      </td>
                    </tr>
                  }
                }
              </tbody>
            </table>
          </div>

          <div class="table-actions">
            <button class="btn btn-primary" routerLink="/main/user/make-action">
              <mat-icon>add</mat-icon>
              Nova Solicitação
            </button>
            <button class="btn btn-secondary">
              <mat-icon>download</mat-icon>
              Exportar Dados
            </button>
          </div>
        </div>
      }

      <div class="stats-overview">
        <div class="stat-card card">
          <div class="stat-icon">
            <mat-icon>trending_up</mat-icon>
          </div>
          <div class="stat-content">
            <div class="stat-number">{{ thisMonthCount }}</div>
            <div class="stat-label">Este Mês</div>
          </div>
        </div>

        <div class="stat-card card">
          <div class="stat-icon">
            <mat-icon>history</mat-icon>
          </div>
          <div class="stat-content">
            <div class="stat-number">{{ totalCount }}</div>
            <div class="stat-label">Total</div>
          </div>
        </div>

        <div class="stat-card card">
          <div class="stat-icon">
            <mat-icon>inventory</mat-icon>
          </div>
          <div class="stat-content">
            <div class="stat-number">{{ availableCount }}</div>
            <div class="stat-label">{{ userType === 'beneficiary' ? 'Pendente' : 'Disponíveis' }}</div>
          </div>
        </div>

        <div class="stat-card card">
          <div class="stat-icon">
            <mat-icon>done_all</mat-icon>
          </div>
          <div class="stat-content">
            <div class="stat-number">{{ usedCount }}</div>
            <div class="stat-label">{{ userType === 'beneficiary' ? 'Coletada' : 'Utilizadas' }}</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>